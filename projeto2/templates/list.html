<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Ambientes Criados</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        body { font-family: Arial, sans-serif; background: #f9f9f9; text-align: center; }
        table { border-collapse: collapse; width: 90%; margin: auto; background: white; }
        th, td { border: 1px solid #ccc; padding: 8px; }
        th { background: #0078d7; color: white; }
        tr:nth-child(even) { background: #f2f2f2; }
        h1 { color: #333; }
        pre { text-align: left; background: #111; color: #0f0; padding: 10px; width: 90%; margin: auto; border-radius: 5px; }
        a { color: #0078d7; text-decoration: none; }
        a:hover { text-decoration: underline; }
        .btn { padding: 5px 10px; border-radius: 4px; background: #0078d7; color: white; text-decoration: none; }
        .btn:hover { background: #005fa3; }
    </style>
</head>
<body>
    <h1>üåê Ambientes em Execu√ß√£o</h1>

    <table>
        <tr>
            <th>Nome</th>
            <th>CPU</th>
            <th>Mem√≥ria</th>
            <th>Status</th>
            <th>Criado em</th>
            <th>A√ß√µes</th>
        </tr>
        {% for e in envs %}
        <tr>
            <td>{{ e[1] }}</td>
            <td>{{ e[2] }}</td>
            <td>{{ e[3] }}</td>
            <td>{{ e[4] }}</td>
            <td>{{ e[5] }}</td>
            <td>
                <a class="btn" href="/log/{{ e[1] }}">Ver Log</a>
                <a class="btn" href="/stop/{{ e[1] }}">Encerrar</a>
                <a class="btn" href="/restart/{{ e[1] }}">Reiniciar</a>
            </td>
        </tr>
        {% endfor %}
    </table>

    <br>
    <a href="/">‚Üê Criar novo ambiente</a>
    
    <h2>üìä Processos Ativos (TOP)</h2>
    <div id="top-container">
        <pre>Carregando processos...</pre>
    </div>

    <script>
    async function atualizarTop() {
        try {
            const response = await fetch("/top");
            const html = await response.text();
            document.getElementById("top-container").innerHTML = html;
        } catch (e) {
            document.getElementById("top-container").innerHTML = "<pre>Erro ao atualizar TOP.</pre>";
        }
    }

    atualizarTop();
    setInterval(atualizarTop, 1000);
    </script>

</body>
</html>
